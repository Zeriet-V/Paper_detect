# è®ºæ–‡æ ¼å¼æ£€æµ‹ç³»ç»Ÿ - æ¥å£è®¾è®¡æ–‡æ¡£

## æ¥å£åˆ—è¡¨

| æ¥å£åç§° | æ¥å£åœ°å€ | è¯·æ±‚æ–¹å¼ | è¯·æ±‚å‚æ•° | è¿”å›ä¿¡æ¯ | æ¥å£æè¿° |
|---------|---------|---------|---------|---------|---------|
| ç”¨æˆ·ç™»å½• | /login | POST | ç”¨æˆ·åã€å¯†ç  | ç™»å½•çŠ¶æ€ã€ç”¨æˆ·ä¿¡æ¯ã€ä¼šè¯ä»¤ç‰Œ | ç”¨äºéªŒè¯ç”¨æˆ·ä¿¡æ¯å¹¶åˆ›å»ºç™»å½•ä¼šè¯çš„æ¥å£ |
| ç”¨æˆ·æ³¨å†Œ | /register | POST | ç”¨æˆ·åã€å¯†ç ã€é‚®ç®± | æ³¨å†ŒçŠ¶æ€ã€ç”¨æˆ·ID | ç”¨äºæ³¨å†Œæ–°ç”¨æˆ·è´¦å·çš„æ¥å£ |
| ç”¨æˆ·ç™»å‡º | /logout | POST | ä¼šè¯ä»¤ç‰Œ | ç™»å‡ºçŠ¶æ€ | ç”¨äºæ³¨é”€ç”¨æˆ·ä¼šè¯çš„æ¥å£ |
| ç¨¿ä»¶ä¸Šä¼  | /manuscript/upload | POST | æ–‡ä»¶ã€ç”¨æˆ·ID | ä¸Šä¼ çŠ¶æ€ã€ç¨¿ä»¶ID | ç”¨äºä¸Šä¼ è®ºæ–‡ç¨¿ä»¶åˆ°ç³»ç»Ÿçš„æ¥å£ |
| ç¨¿ä»¶åˆ—è¡¨ | /manuscript/list | POST | ç”¨æˆ·IDã€çŠ¶æ€ç­›é€‰ | ç¨¿ä»¶åˆ—è¡¨ | ç”¨äºè·å–ç”¨æˆ·æ‰€æœ‰ç¨¿ä»¶åˆ—è¡¨çš„æ¥å£ |
| ç¨¿ä»¶ä¸‹è½½ | /manuscript/download | POST | ç¨¿ä»¶IDã€ç”¨æˆ·ID | æ–‡ä»¶ä¸‹è½½åœ°å€ | ç”¨äºä¸‹è½½åŸå§‹ç¨¿ä»¶æ–‡ä»¶çš„æ¥å£ |
| ç¨¿ä»¶åˆ é™¤ | /manuscript/delete | POST | ç¨¿ä»¶IDã€ç”¨æˆ·ID | åˆ é™¤çŠ¶æ€ | ç”¨äºåˆ é™¤æŒ‡å®šç¨¿ä»¶åŠå…¶å…³è”æ•°æ®çš„æ¥å£ |
| å¯åŠ¨æ£€æµ‹ | /detection/start | POST | ç¨¿ä»¶IDã€æ˜¯å¦å¯ç”¨å›¾ç‰‡API | ä»»åŠ¡IDã€ä»»åŠ¡çŠ¶æ€ | ç”¨äºåˆ›å»ºå¹¶å¯åŠ¨æ ¼å¼æ£€æµ‹ä»»åŠ¡çš„æ¥å£ |
| æ£€æµ‹çŠ¶æ€ | /detection/status | POST | ä»»åŠ¡ID | ä»»åŠ¡çŠ¶æ€ã€è¿›åº¦ç™¾åˆ†æ¯” | ç”¨äºæŸ¥è¯¢æ£€æµ‹ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€çš„æ¥å£ |
| æ£€æµ‹ç»“æœ | /detection/result | POST | ä»»åŠ¡ID | æ£€æµ‹ç»“æœJSON | ç”¨äºè·å–æ£€æµ‹ä»»åŠ¡å®Œæ•´ç»“æœçš„æ¥å£ |
| å›¾ç‰‡åˆ—è¡¨ | /figure/list | POST | ä»»åŠ¡IDã€ç¨¿ä»¶ID | å›¾ç‰‡åˆ—è¡¨ | ç”¨äºè·å–ç¨¿ä»¶æå–çš„æ‰€æœ‰å›¾ç‰‡åˆ—è¡¨çš„æ¥å£ |
| å›¾ç‰‡ä¸‹è½½ | /figure/download | POST | å›¾ç‰‡ID | å›¾ç‰‡æ–‡ä»¶ä¸‹è½½åœ°å€ | ç”¨äºä¸‹è½½æå–çš„å›¾ç‰‡æ–‡ä»¶çš„æ¥å£ |
| å›¾ç‰‡å†…å®¹æ£€æµ‹ç»“æœ | /figure/content | POST | å›¾ç‰‡ID | å›¾è¡¨ç±»å‹ã€5é¡¹æ£€æµ‹ç»“æœ | ç”¨äºè·å–å›¾ç‰‡AIå†…å®¹æ£€æµ‹è¯¦æƒ…çš„æ¥å£ |
| ç”Ÿæˆæ–‡æœ¬æŠ¥å‘Š | /report/generate/text | POST | ä»»åŠ¡ID | æŠ¥å‘Šè·¯å¾„ã€ç”ŸæˆçŠ¶æ€ | ç”¨äºç”Ÿæˆæ–‡æœ¬æ ¼å¼æ£€æµ‹æŠ¥å‘Šçš„æ¥å£ |
| ç”Ÿæˆæ‰¹æ³¨æŠ¥å‘Š | /report/generate/annotated | POST | ä»»åŠ¡ID | æŠ¥å‘Šè·¯å¾„ã€ç”ŸæˆçŠ¶æ€ | ç”¨äºç”Ÿæˆå¸¦æ‰¹æ³¨Wordæ–‡æ¡£çš„æ¥å£ |
| æŠ¥å‘Šä¸‹è½½ | /report/download | POST | æŠ¥å‘ŠIDã€æŠ¥å‘Šç±»å‹ | æ–‡ä»¶ä¸‹è½½åœ°å€ | ç”¨äºä¸‹è½½æ£€æµ‹æŠ¥å‘Šæ–‡ä»¶çš„æ¥å£ |
| æ¨¡æ¿åˆ—è¡¨ | /template/list | POST | æ¨¡æ¿ç±»å‹ | æ¨¡æ¿åˆ—è¡¨ | ç”¨äºè·å–æ£€æµ‹æ¨¡æ¿åˆ—è¡¨çš„æ¥å£ |
| æ¨¡æ¿ä¸Šä¼  | /template/upload | POST | æ¨¡æ¿æ–‡ä»¶ã€æ¨¡æ¿åç§°ã€æ¨¡æ¿ç±»å‹ | ä¸Šä¼ çŠ¶æ€ã€æ¨¡æ¿ID | ç”¨äºä¸Šä¼ æ–°æ£€æµ‹æ¨¡æ¿çš„æ¥å£ï¼ˆç®¡ç†å‘˜ï¼‰ |
| æ¨¡æ¿ä¿®æ”¹ | /template/update | POST | æ¨¡æ¿IDã€é…ç½®JSON | ä¿®æ”¹çŠ¶æ€ | ç”¨äºä¿®æ”¹æ¨¡æ¿é…ç½®çš„æ¥å£ï¼ˆç®¡ç†å‘˜ï¼‰ |
| æ¨¡æ¿åˆ é™¤ | /template/delete | POST | æ¨¡æ¿ID | åˆ é™¤çŠ¶æ€ | ç”¨äºåˆ é™¤æ£€æµ‹æ¨¡æ¿çš„æ¥å£ï¼ˆç®¡ç†å‘˜ï¼‰ |
| APIç»Ÿè®¡ | /api/statistics | POST | ä»»åŠ¡IDã€æ—¶é—´èŒƒå›´ | Tokenæ¶ˆè€—ã€è´¹ç”¨ç»Ÿè®¡ | ç”¨äºæŸ¥è¯¢APIè°ƒç”¨ç»Ÿè®¡å’Œè´¹ç”¨çš„æ¥å£ |

---

## æ¥å£è¯¦ç»†è®¾è®¡

### 1. ç”¨æˆ·ç®¡ç†æ¥å£

#### 1.1 ç”¨æˆ·ç™»å½•

**æ¥å£åç§°**ï¼šç”¨æˆ·ç™»å½•  
**æ¥å£åœ°å€**ï¼š`/login`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºéªŒè¯ç”¨æˆ·ä¿¡æ¯å¹¶åˆ›å»ºç™»å½•ä¼šè¯çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "username": "zhangsan",
  "password": "123456"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "user_id": 1,
    "username": "zhangsan",
    "user_type": "author",
    "session_id": "abc123...",
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_at": "2025-10-29 14:30:00"
  }
}
```

---

#### 1.2 ç”¨æˆ·æ³¨å†Œ

**æ¥å£åç§°**ï¼šç”¨æˆ·æ³¨å†Œ  
**æ¥å£åœ°å€**ï¼š`/register`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºæ³¨å†Œæ–°ç”¨æˆ·è´¦å·çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "username": "lisi",
  "password": "123456",
  "email": "lisi@example.com"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "data": {
    "user_id": 2,
    "username": "lisi"
  }
}
```

---

#### 1.3 ç”¨æˆ·ç™»å‡º

**æ¥å£åç§°**ï¼šç”¨æˆ·ç™»å‡º  
**æ¥å£åœ°å€**ï¼š`/logout`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºæ³¨é”€ç”¨æˆ·ä¼šè¯çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "session_id": "abc123...",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "ç™»å‡ºæˆåŠŸ"
}
```

---

### 2. ç¨¿ä»¶ç®¡ç†æ¥å£

#### 2.1 ç¨¿ä»¶ä¸Šä¼ 

**æ¥å£åç§°**ï¼šç¨¿ä»¶ä¸Šä¼   
**æ¥å£åœ°å€**ï¼š`/manuscript/upload`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST (multipart/form-data)  
**æ¥å£æè¿°**ï¼šç”¨äºä¸Šä¼ è®ºæ–‡ç¨¿ä»¶åˆ°ç³»ç»Ÿçš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```
file: æ–‡ä»¶å¯¹è±¡ï¼ˆ.docxæ ¼å¼ï¼‰
user_id: ç”¨æˆ·ID
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "ä¸Šä¼ æˆåŠŸ",
  "data": {
    "manuscript_id": 10,
    "title": "Calculating Sound Absorption...",
    "author_names": "ZHU C Y, SHAO Z Y",
    "file_name": "paper.docx",
    "file_hash": "abc123def456...",
    "upload_time": "2025-10-28 14:30:00"
  }
}
```

---

#### 2.2 ç¨¿ä»¶åˆ—è¡¨

**æ¥å£åç§°**ï¼šç¨¿ä»¶åˆ—è¡¨  
**æ¥å£åœ°å€**ï¼š`/manuscript/list`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºè·å–ç”¨æˆ·æ‰€æœ‰ç¨¿ä»¶åˆ—è¡¨çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "user_id": 1,
  "status": "all"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "total": 5,
    "manuscripts": [
      {
        "manuscript_id": 10,
        "title": "Calculating Sound Absorption...",
        "author_names": "ZHU C Y, SHAO Z Y",
        "upload_time": "2025-10-28 14:30:00",
        "file_name": "paper.docx"
      }
    ]
  }
}
```

---

#### 2.3 ç¨¿ä»¶ä¸‹è½½

**æ¥å£åç§°**ï¼šç¨¿ä»¶ä¸‹è½½  
**æ¥å£åœ°å€**ï¼š`/manuscript/download`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºä¸‹è½½åŸå§‹ç¨¿ä»¶æ–‡ä»¶çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "manuscript_id": 10,
  "user_id": 1
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æ–‡ä»¶å‡†å¤‡å®Œæˆ",
  "data": {
    "download_url": "/files/manuscript_10.docx",
    "file_name": "paper.docx",
    "file_size": 2560000
  }
}
```

---

#### 2.4 ç¨¿ä»¶åˆ é™¤

**æ¥å£åç§°**ï¼šç¨¿ä»¶åˆ é™¤  
**æ¥å£åœ°å€**ï¼š`/manuscript/delete`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºåˆ é™¤æŒ‡å®šç¨¿ä»¶åŠå…¶å…³è”æ•°æ®çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "manuscript_id": 10,
  "user_id": 1,
  "delete_detections": true
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "åˆ é™¤æˆåŠŸ",
  "data": {
    "deleted_files": 1,
    "deleted_detections": 3,
    "deleted_reports": 3
  }
}
```

---

### 3. æ ¼å¼æ£€æµ‹æ¥å£

#### 3.1 å¯åŠ¨æ£€æµ‹

**æ¥å£åç§°**ï¼šå¯åŠ¨æ£€æµ‹  
**æ¥å£åœ°å€**ï¼š`/detection/start`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºåˆ›å»ºå¹¶å¯åŠ¨æ ¼å¼æ£€æµ‹ä»»åŠ¡çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "manuscript_id": 10,
  "user_id": 1,
  "enable_figure_api": false
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æ£€æµ‹ä»»åŠ¡å·²åˆ›å»º",
  "data": {
    "task_id": "abc-123-def-456",
    "status": "pending",
    "created_at": "2025-10-28 14:30:00"
  }
}
```

---

#### 3.2 æ£€æµ‹çŠ¶æ€

**æ¥å£åç§°**ï¼šæ£€æµ‹çŠ¶æ€  
**æ¥å£åœ°å€**ï¼š`/detection/status`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºæŸ¥è¯¢æ£€æµ‹ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "task_id": "abc-123-def-456"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "task_id": "abc-123-def-456",
    "status": "processing",
    "progress": 65.5,
    "current_module": "Figure",
    "started_at": "2025-10-28 14:30:05",
    "estimated_remaining": 120
  }
}
```

---

#### 3.3 æ£€æµ‹ç»“æœ

**æ¥å£åç§°**ï¼šæ£€æµ‹ç»“æœ  
**æ¥å£åœ°å€**ï¼š`/detection/result`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºè·å–æ£€æµ‹ä»»åŠ¡å®Œæ•´ç»“æœçš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "task_id": "abc-123-def-456"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "task_id": "abc-123-def-456",
    "status": "completed",
    "overall_pass_rate": 72.0,
    "total_issues": 18,
    "modules": {
      "Title": {"status": "fail", "passed": 3, "failed": 1},
      "Abstract": {"status": "fail", "passed": 2, "failed": 1},
      "Figure": {"status": "fail", "passed": 0, "failed": 2}
    },
    "completed_at": "2025-10-28 14:32:15"
  }
}
```

---

### 4. å›¾ç‰‡ç®¡ç†æ¥å£

#### 4.1 å›¾ç‰‡åˆ—è¡¨

**æ¥å£åç§°**ï¼šå›¾ç‰‡åˆ—è¡¨  
**æ¥å£åœ°å€**ï¼š`/figure/list`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºè·å–ç¨¿ä»¶æå–çš„æ‰€æœ‰å›¾ç‰‡åˆ—è¡¨çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "task_id": "abc-123-def-456",
  "manuscript_id": 10
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "total": 2,
    "figures": [
      {
        "figure_id": 50,
        "figure_index": 1,
        "figure_number": 5,
        "has_caption": true,
        "caption_text": "Fig. 5 Comparison of...",
        "image_path": "/figures/test_Fig5.png",
        "chart_type": "æŠ˜çº¿å›¾"
      },
      {
        "figure_id": 51,
        "figure_index": 2,
        "figure_number": null,
        "has_caption": false,
        "caption_text": null,
        "image_path": "/figures/test_Fig2.png",
        "chart_type": "ç…§ç‰‡"
      }
    ]
  }
}
```

---

#### 4.2 å›¾ç‰‡ä¸‹è½½

**æ¥å£åç§°**ï¼šå›¾ç‰‡ä¸‹è½½  
**æ¥å£åœ°å€**ï¼š`/figure/download`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºä¸‹è½½æå–çš„å›¾ç‰‡æ–‡ä»¶çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "figure_id": 50
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æ–‡ä»¶å‡†å¤‡å®Œæˆ",
  "data": {
    "download_url": "/files/test_Fig5.png",
    "file_name": "test_Fig5.png",
    "file_size": 256000
  }
}
```

---

#### 4.3 å›¾ç‰‡å†…å®¹æ£€æµ‹ç»“æœ

**æ¥å£åç§°**ï¼šå›¾ç‰‡å†…å®¹æ£€æµ‹ç»“æœ  
**æ¥å£åœ°å€**ï¼š`/figure/content`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºè·å–å›¾ç‰‡AIå†…å®¹æ£€æµ‹è¯¦æƒ…çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "figure_id": 50
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "figure_id": 50,
    "is_chart": true,
    "chart_type": "æŠ˜çº¿å›¾",
    "checks": {
      "tick_direction": {"ok": false, "description": "åˆ»åº¦çº¿æŒ‡å‘å›¾å¤–"},
      "unit_format": {"ok": true, "issues": []},
      "unit_brackets": {"ok": false, "issues": ["V/måº”ä¸º(V/m)"]},
      "decimal_consistency": {"ok": true, "description": "å°æ•°ä½ä¸€è‡´"},
      "axis_title_consistency": {"ok": true, "description": "éƒ½ç”¨ç¬¦å·"}
    }
  }
}
```

---

### 5. æŠ¥å‘Šç®¡ç†æ¥å£

#### 5.1 ç”Ÿæˆæ–‡æœ¬æŠ¥å‘Š

**æ¥å£åç§°**ï¼šç”Ÿæˆæ–‡æœ¬æŠ¥å‘Š  
**æ¥å£åœ°å€**ï¼š`/report/generate/text`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºç”Ÿæˆæ–‡æœ¬æ ¼å¼æ£€æµ‹æŠ¥å‘Šçš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "task_id": "abc-123-def-456"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æŠ¥å‘Šç”ŸæˆæˆåŠŸ",
  "data": {
    "report_id": 80,
    "report_type": "text",
    "report_path": "/reports/test_report.txt",
    "file_size": 5120,
    "generated_at": "2025-10-28 14:33:00"
  }
}
```

---

#### 5.2 ç”Ÿæˆæ‰¹æ³¨æŠ¥å‘Š

**æ¥å£åç§°**ï¼šç”Ÿæˆæ‰¹æ³¨æŠ¥å‘Š  
**æ¥å£åœ°å€**ï¼š`/report/generate/annotated`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºç”Ÿæˆå¸¦æ‰¹æ³¨Wordæ–‡æ¡£çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "task_id": "abc-123-def-456"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æ‰¹æ³¨æŠ¥å‘Šç”ŸæˆæˆåŠŸ",
  "data": {
    "report_id": 80,
    "report_type": "annotated",
    "report_path": "/reports/test_annotated.docx",
    "file_size": 2800000,
    "total_comments": 18,
    "generated_at": "2025-10-28 14:33:15"
  }
}
```

---

#### 5.3 æŠ¥å‘Šä¸‹è½½

**æ¥å£åç§°**ï¼šæŠ¥å‘Šä¸‹è½½  
**æ¥å£åœ°å€**ï¼š`/report/download`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºä¸‹è½½æ£€æµ‹æŠ¥å‘Šæ–‡ä»¶çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "report_id": 80,
  "report_type": "text"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æ–‡ä»¶å‡†å¤‡å®Œæˆ",
  "data": {
    "download_url": "/files/test_report.txt",
    "file_name": "test_report.txt",
    "file_size": 5120
  }
}
```

---

### 6. æ¨¡æ¿ç®¡ç†æ¥å£

#### 6.1 æ¨¡æ¿åˆ—è¡¨

**æ¥å£åç§°**ï¼šæ¨¡æ¿åˆ—è¡¨  
**æ¥å£åœ°å€**ï¼š`/template/list`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºè·å–æ£€æµ‹æ¨¡æ¿åˆ—è¡¨çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "template_type": "Figure"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "total": 3,
    "templates": [
      {
        "template_id": 1,
        "template_name": "æ ‡å‡†å›¾ç‰‡æ£€æµ‹è§„åˆ™",
        "template_type": "Figure",
        "is_default": true,
        "is_active": true,
        "created_at": "2025-10-01 10:00:00"
      },
      {
        "template_id": 2,
        "template_name": "ä¸¥æ ¼å›¾ç‰‡æ£€æµ‹è§„åˆ™",
        "template_type": "Figure",
        "is_default": false,
        "is_active": true,
        "created_at": "2025-10-15 11:00:00"
      }
    ]
  }
}
```

---

#### 6.2 æ¨¡æ¿ä¸Šä¼ 

**æ¥å£åç§°**ï¼šæ¨¡æ¿ä¸Šä¼   
**æ¥å£åœ°å€**ï¼š`/template/upload`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºä¸Šä¼ æ–°æ£€æµ‹æ¨¡æ¿çš„æ¥å£ï¼ˆä»…ç®¡ç†å‘˜ï¼‰

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "template_name": "è‡ªå®šä¹‰Figureæ¨¡æ¿",
  "template_type": "Figure",
  "config_json": {
    "format_rules": {...},
    "check_rules": {...},
    "messages": {...}
  },
  "user_id": 1
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æ¨¡æ¿ä¸Šä¼ æˆåŠŸ",
  "data": {
    "template_id": 3,
    "template_name": "è‡ªå®šä¹‰Figureæ¨¡æ¿",
    "created_at": "2025-10-28 15:00:00"
  }
}
```

---

#### 6.3 æ¨¡æ¿ä¿®æ”¹

**æ¥å£åç§°**ï¼šæ¨¡æ¿ä¿®æ”¹  
**æ¥å£åœ°å€**ï¼š`/template/update`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºä¿®æ”¹æ¨¡æ¿é…ç½®çš„æ¥å£ï¼ˆä»…ç®¡ç†å‘˜ï¼‰

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "template_id": 3,
  "config_json": {
    "format_rules": {...},
    "check_rules": {...}
  },
  "user_id": 1
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æ¨¡æ¿ä¿®æ”¹æˆåŠŸ",
  "data": {
    "template_id": 3,
    "old_version": 1,
    "new_version": 2,
    "updated_at": "2025-10-28 15:10:00"
  }
}
```

---

#### 6.4 æ¨¡æ¿åˆ é™¤

**æ¥å£åç§°**ï¼šæ¨¡æ¿åˆ é™¤  
**æ¥å£åœ°å€**ï¼š`/template/delete`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºåˆ é™¤æ£€æµ‹æ¨¡æ¿çš„æ¥å£ï¼ˆä»…ç®¡ç†å‘˜ï¼‰

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "template_id": 3,
  "user_id": 1
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æ¨¡æ¿åˆ é™¤æˆåŠŸ"
}
```

---

### 7. ç»Ÿè®¡åˆ†ææ¥å£

#### 7.1 APIç»Ÿè®¡

**æ¥å£åç§°**ï¼šAPIç»Ÿè®¡  
**æ¥å£åœ°å€**ï¼š`/api/statistics`  
**è¯·æ±‚æ–¹å¼**ï¼šPOST  
**æ¥å£æè¿°**ï¼šç”¨äºæŸ¥è¯¢APIè°ƒç”¨ç»Ÿè®¡å’Œè´¹ç”¨çš„æ¥å£

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "task_id": "abc-123-def-456",
  "start_time": "2025-10-01 00:00:00",
  "end_time": "2025-10-31 23:59:59"
}
```

**è¿”å›ä¿¡æ¯**ï¼š
```json
{
  "code": 200,
  "message": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "total_calls": 12,
    "successful_calls": 11,
    "failed_calls": 1,
    "total_tokens": 1200,
    "total_cost": 0.15,
    "average_duration": 850,
    "by_check_type": {
      "is_chart": 2,
      "tick_direction": 2,
      "unit_format": 2,
      "unit_brackets": 2,
      "decimal_consistency": 2,
      "axis_title_consistency": 2
    }
  }
}
```

---

## ğŸ“Š æ¥å£åˆ†ç±»æ±‡æ€»

### æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç±»

| æ¨¡å— | æ¥å£æ•°é‡ | æ¥å£åˆ—è¡¨ |
|------|---------|---------|
| **ç”¨æˆ·ç®¡ç†** | 3 | ç™»å½•ã€æ³¨å†Œã€ç™»å‡º |
| **ç¨¿ä»¶ç®¡ç†** | 4 | ä¸Šä¼ ã€åˆ—è¡¨ã€ä¸‹è½½ã€åˆ é™¤ |
| **æ ¼å¼æ£€æµ‹** | 3 | å¯åŠ¨æ£€æµ‹ã€æŸ¥è¯¢çŠ¶æ€ã€è·å–ç»“æœ |
| **å›¾ç‰‡ç®¡ç†** | 3 | å›¾ç‰‡åˆ—è¡¨ã€å›¾ç‰‡ä¸‹è½½ã€å†…å®¹æ£€æµ‹ç»“æœ |
| **æŠ¥å‘Šç®¡ç†** | 3 | ç”Ÿæˆæ–‡æœ¬æŠ¥å‘Šã€ç”Ÿæˆæ‰¹æ³¨æŠ¥å‘Šã€æŠ¥å‘Šä¸‹è½½ |
| **æ¨¡æ¿ç®¡ç†** | 4 | æ¨¡æ¿åˆ—è¡¨ã€ä¸Šä¼ ã€ä¿®æ”¹ã€åˆ é™¤ |
| **ç»Ÿè®¡åˆ†æ** | 1 | APIç»Ÿè®¡ |
| **æ€»è®¡** | 21 | 21ä¸ªæ¥å£ |

---

## ğŸ” æ¥å£æƒé™è¯´æ˜

### æƒé™çº§åˆ«

| æƒé™çº§åˆ« | è§’è‰² | å¯è®¿é—®æ¥å£ |
|---------|------|-----------|
| **å…¬å¼€** | æ‰€æœ‰äºº | ç™»å½•ã€æ³¨å†Œ |
| **å·²ç™»å½•** | authorã€admin | ç™»å‡ºã€ç¨¿ä»¶ä¸Šä¼ /åˆ—è¡¨/ä¸‹è½½ã€å¯åŠ¨æ£€æµ‹ã€æŸ¥è¯¢çŠ¶æ€ã€è·å–ç»“æœã€å›¾ç‰‡ç›¸å…³ã€æŠ¥å‘Šç›¸å…³ |
| **ç®¡ç†å‘˜** | admin | æ¨¡æ¿ä¸Šä¼ /ä¿®æ”¹/åˆ é™¤ã€APIç»Ÿè®¡ã€æ‰€æœ‰ç”¨æˆ·çš„ç¨¿ä»¶æŸ¥çœ‹ |

### æ¥å£é‰´æƒ

æ‰€æœ‰éœ€è¦ç™»å½•çš„æ¥å£éƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦tokenï¼š

```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

---

## ğŸ“‹ é€šç”¨è¿”å›æ ¼å¼

### æˆåŠŸå“åº”

```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": { ... }
}
```

### é”™è¯¯å“åº”

```json
{
  "code": 400/401/403/404/500,
  "message": "é”™è¯¯æè¿°",
  "error": "è¯¦ç»†é”™è¯¯ä¿¡æ¯"
}
```

### çŠ¶æ€ç è¯´æ˜

| çŠ¶æ€ç  | è¯´æ˜ |
|-------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªç™»å½•æˆ–ä¼šè¯è¿‡æœŸ |
| 403 | æƒé™ä¸è¶³ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

---

## ğŸš€ æ¥å£ä½¿ç”¨æµç¨‹ç¤ºä¾‹

### å®Œæ•´æ£€æµ‹æµç¨‹

```
1. ç”¨æˆ·ç™»å½•
   POST /login
   â†“
2. ä¸Šä¼ ç¨¿ä»¶
   POST /manuscript/upload
   â†“ (è·å¾—manuscript_id)
3. å¯åŠ¨æ£€æµ‹
   POST /detection/start
   â†“ (è·å¾—task_id)
4. è½®è¯¢æŸ¥è¯¢çŠ¶æ€
   POST /detection/status (æ¯3ç§’æŸ¥è¯¢ä¸€æ¬¡)
   â†“ (statuså˜ä¸ºcompleted)
5. è·å–æ£€æµ‹ç»“æœ
   POST /detection/result
   â†“
6. ç”Ÿæˆæ‰¹æ³¨æŠ¥å‘Š
   POST /report/generate/annotated
   â†“ (è·å¾—report_id)
7. ä¸‹è½½æŠ¥å‘Š
   POST /report/download
```

---

è¿™ä¸ªæ¥å£è®¾è®¡æ˜¯å¦ç¬¦åˆæ‚¨çš„è¦æ±‚ï¼Ÿéœ€è¦è°ƒæ•´æˆ–è¡¥å……å“ªäº›æ¥å£å—ï¼Ÿ
