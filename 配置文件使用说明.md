# é…ç½®æ–‡ä»¶ä½¿ç”¨è¯´æ˜

## ğŸ“‹ é…ç½®ç³»ç»Ÿæ¦‚è¿°

ç°åœ¨ç³»ç»Ÿæ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†APIå¯†é’¥å’Œå…¶ä»–è®¾ç½®ï¼Œæ— éœ€åœ¨å‘½ä»¤è¡Œä¸­ä¼ é€’æ•æ„Ÿä¿¡æ¯ã€‚

## ğŸ”§ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»ºé…ç½®æ–‡ä»¶

æ‚¨çš„é…ç½®æ–‡ä»¶ `config_api.py` å·²ç»åˆ›å»ºå¥½äº†ï¼š

```python
# config_api.py
SILICONFLOW_API_KEY = "sk-vverzmmnhjuobkiztovwgmgbjpnzmhfopyzluzjqukcoygha"
SILICONFLOW_API_BASE = "https://api.siliconflow.cn/v1"
SILICONFLOW_MODEL = "Qwen/Qwen3-VL-32B-Instruct"

ENABLE_FIGURE_CONTENT_CHECK = True  # å¯ç”¨å›¾ç‰‡å†…å®¹æ£€æµ‹
SAVE_EXTRACTED_IMAGES = True  # æ°¸ä¹…ä¿å­˜æå–çš„å›¾ç‰‡
EXTRACTED_IMAGES_DIR = "extracted_figures"
```

âš ï¸ **é‡è¦**ï¼š`config_api.py` å·²æ·»åŠ åˆ° `.gitignore`ï¼Œä¸ä¼šè¢«æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚

### 2. æµ‹è¯•é…ç½®

```bash
# æµ‹è¯•é…ç½®æ˜¯å¦æ­£ç¡®åŠ è½½
python paper_detect/config_loader.py
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
âœ“ å·²åŠ è½½é…ç½®æ–‡ä»¶: D:\pyproject\paper_detect\config_api.py
é…ç½®é¡¹:
  APIå¯†é’¥: sk-vverzmmnhjuobkizt...
  APIåŸºç¡€URL: https://api.siliconflow.cn/v1
  æ¨¡å‹åç§°: Qwen/Qwen3-VL-32B-Instruct
  å¯ç”¨å†…å®¹æ£€æµ‹: True
  ä¿å­˜å›¾ç‰‡: True
  å›¾ç‰‡ç›®å½•: extracted_figures
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šå®Œå…¨è‡ªåŠ¨ï¼ˆæ¨èï¼‰

ç›´æ¥è¿è¡Œï¼Œæ— éœ€ä»»ä½•å‚æ•°ï¼š

```bash
# æ£€æµ‹å›¾ç‰‡ï¼ˆè‡ªåŠ¨ä»é…ç½®æ–‡ä»¶è¯»å–APIå¯†é’¥ï¼‰
python test_figure_with_api.py template/test.docx
```

ç³»ç»Ÿä¼šï¼š
1. è‡ªåŠ¨ä» `config_api.py` è¯»å–APIå¯†é’¥
2. ä½¿ç”¨é…ç½®çš„æ¨¡å‹åç§°
3. æŒ‰é…ç½®å†³å®šæ˜¯å¦ä¿å­˜å›¾ç‰‡

### æ–¹å¼2ï¼šå‘½ä»¤è¡Œè¦†ç›–

ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå‚æ•°è¦†ç›–é…ç½®ï¼š

```bash
# ä½¿ç”¨ä¸åŒçš„APIå¯†é’¥
python test_figure_with_api.py template/test.docx sk-another-key
```

ä¼˜å…ˆçº§ï¼š**å‘½ä»¤è¡Œå‚æ•° > é…ç½®æ–‡ä»¶**

### æ–¹å¼3ï¼šåœ¨ä»£ç ä¸­ä½¿ç”¨

```python
from paper_detect.Figure_content_detect import FigureContentDetector

# è‡ªåŠ¨ä»é…ç½®æ–‡ä»¶è¯»å–æ‰€æœ‰è®¾ç½®
detector = FigureContentDetector()

# æˆ–è€…è¦†ç›–éƒ¨åˆ†è®¾ç½®
detector = FigureContentDetector(save_images=False)  # ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶

# å®Œå…¨è‡ªå®šä¹‰
detector = FigureContentDetector(
    api_key='sk-custom-key',
    model='other-model',
    save_images=True,
    image_dir='my_images'
)
```

## âš™ï¸ é…ç½®é¡¹è¯´æ˜

### APIç›¸å…³

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|-------|------|--------|
| `SILICONFLOW_API_KEY` | APIå¯†é’¥ | å¿…å¡« |
| `SILICONFLOW_API_BASE` | APIåŸºç¡€URL | `https://api.siliconflow.cn/v1` |
| `SILICONFLOW_MODEL` | è§†è§‰æ¨¡å‹åç§° | `Qwen/Qwen3-VL-32B-Instruct` |

### å›¾ç‰‡æ£€æµ‹ç›¸å…³

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|-------|------|--------|
| `ENABLE_FIGURE_CONTENT_CHECK` | æ˜¯å¦å¯ç”¨å›¾ç‰‡å†…å®¹æ£€æµ‹ | `False` |
| `SAVE_EXTRACTED_IMAGES` | æ˜¯å¦æ°¸ä¹…ä¿å­˜æå–çš„å›¾ç‰‡ | `True` |
| `EXTRACTED_IMAGES_DIR` | å›¾ç‰‡ä¿å­˜ç›®å½• | `extracted_figures` |

## ğŸ“ é…ç½®æ–‡ä»¶æŸ¥æ‰¾é¡ºåº

ç³»ç»ŸæŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼ˆæ‰¾åˆ°ç¬¬ä¸€ä¸ªå³åœæ­¢ï¼‰ï¼š

1. é¡¹ç›®æ ¹ç›®å½•ï¼š`./config_api.py`
2. å½“å‰å·¥ä½œç›®å½•ï¼š`$(pwd)/config_api.py`
3. ç”¨æˆ·ä¸»ç›®å½•ï¼š`~/.paper_detect_config.py`

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¸è¦å°† `config_api.py` æäº¤åˆ°Git**
   - å·²è‡ªåŠ¨æ·»åŠ åˆ° `.gitignore`
   - åŒ…å«æ•æ„Ÿçš„APIå¯†é’¥

2. **å›¢é˜Ÿåä½œ**
   - å…±äº« `config_api.example.py`ï¼ˆæ¨¡æ¿æ–‡ä»¶ï¼‰
   - æ¯ä¸ªäººç»´æŠ¤è‡ªå·±çš„ `config_api.py`

3. **ç”Ÿäº§ç¯å¢ƒ**
   - ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†ç³»ç»Ÿ
   - ä¸è¦åœ¨é…ç½®æ–‡ä»¶ä¸­ç¡¬ç¼–ç ç”Ÿäº§å¯†é’¥

## ğŸ“ å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šåŸºæœ¬ä½¿ç”¨

```python
from paper_detect.Figure_detect import check_doc_with_template

# è‡ªåŠ¨ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®
result = check_doc_with_template(
    doc_path='paper.docx',
    template_identifier='Figure',
    enable_content_check=True  # å¯ç”¨å†…å®¹æ£€æµ‹
)
```

### ç¤ºä¾‹2ï¼šè¦†ç›–é…ç½®

```python
from paper_detect.Figure_detect import check_doc_with_template

# ä½¿ç”¨ä¸åŒçš„APIå¯†é’¥
result = check_doc_with_template(
    doc_path='paper.docx',
    template_identifier='Figure',
    enable_content_check=True,
    api_key='sk-different-key'  # è¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„å¯†é’¥
)
```

### ç¤ºä¾‹3ï¼šä»£ç ä¸­è·å–é…ç½®

```python
from paper_detect.config_loader import get_config, get_api_key

# è·å–é…ç½®å¯¹è±¡
config = get_config()

# è¯»å–å„é¡¹é…ç½®
api_key = config.api_key
model = config.model
save_images = config.save_images

# æˆ–ä½¿ç”¨ä¾¿æ·å‡½æ•°
api_key = get_api_key()
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šé…ç½®æ–‡ä»¶æœªæ‰¾åˆ°

**é”™è¯¯ä¿¡æ¯**ï¼š
```
è­¦å‘Š: æœªæ‰¾åˆ°é…ç½®æ–‡ä»¶ (config_api.py)
```

**è§£å†³æ–¹æ³•**ï¼š
```bash
# å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶
cp config_api.example.py config_api.py

# ç¼–è¾‘å¹¶å¡«å…¥APIå¯†é’¥
# åœ¨Windowsä¸Šï¼š
notepad config_api.py
```

### é—®é¢˜2ï¼šAPIå¯†é’¥æœªè®¾ç½®

**é”™è¯¯ä¿¡æ¯**ï¼š
```
æœªæä¾›APIå¯†é’¥ã€‚è¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€é…ç½®...
```

**è§£å†³æ–¹æ³•**ï¼š
åœ¨ `config_api.py` ä¸­è®¾ç½®æ­£ç¡®çš„APIå¯†é’¥ï¼š
```python
SILICONFLOW_API_KEY = "sk-your-actual-key-here"
```

### é—®é¢˜3ï¼šé…ç½®æœªç”Ÿæ•ˆ

**æ£€æŸ¥æ­¥éª¤**ï¼š
```bash
# 1. æµ‹è¯•é…ç½®åŠ è½½
python paper_detect/config_loader.py

# 2. æ£€æŸ¥é…ç½®æ–‡ä»¶ä½ç½®
python -c "from pathlib import Path; print('å½“å‰ç›®å½•:', Path.cwd()); print('é¡¹ç›®æ ¹ç›®å½•:', Path(__file__).parent)"

# 3. é‡æ–°åŠ è½½é…ç½®
python -c "from paper_detect.config_loader import get_config; config = get_config(reload=True); config.load()"
```

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `config_api.py` - å®é™…é…ç½®æ–‡ä»¶ï¼ˆä¸ä¼šæäº¤åˆ°Gitï¼‰
- `config_api.example.py` - é…ç½®æ¨¡æ¿ï¼ˆå¯ä»¥æäº¤åˆ°Gitï¼‰
- `paper_detect/config_loader.py` - é…ç½®åŠ è½½å™¨
- `.gitignore_addition.txt` - Gitå¿½ç•¥è§„åˆ™

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å¼€å‘ç¯å¢ƒ**
   - ä½¿ç”¨æœ¬åœ° `config_api.py`
   - å®šæœŸæ›´æ–° `config_api.example.py` æ¨¡æ¿

2. **æµ‹è¯•ç¯å¢ƒ**
   - ä½¿ç”¨æµ‹è¯•ä¸“ç”¨çš„APIå¯†é’¥
   - è®¾ç½® `SAVE_EXTRACTED_IMAGES = False` å‡å°‘ç£ç›˜å ç”¨

3. **ç”Ÿäº§ç¯å¢ƒ**
   - ä»ç¯å¢ƒå˜é‡è¯»å–å¯†é’¥
   - ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡ï¼ˆå¦‚AWS Secrets Managerï¼‰

